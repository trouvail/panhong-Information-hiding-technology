# 信息隐藏技术第五次实验 —— `奇偶校验位隐藏法`

> **学号：2013921  
姓名：周延霖  
专业：信息安全**

## 一、实验摘要
---

### **1.实验要求**

1. 在 `MATLAB` 中调试完成
2. 编程实现，写出实验报告，含程序代码和截图，`word/pdf` 格式
3. `QQ 群`提交作业


### **2.实验内容**

1. **隐藏：** 利用奇偶校验位隐藏法，实现将秘密图像嵌入到位图中
2. **提取：** 将秘密图像提取出来





## 二、实验原理


> 在本次实验中主要有两种可以采用的思路，将在下文中介绍：


### **1.思路一**

思路一主要是是翻转最低位，对图像影响不大，并把载体划分成几个不相重叠的区域，在一个载体区域中存储`1 bit`信息



- 1、嵌入

首先选择 `L(m)` 个不相重叠区域，计算各个区域所有最低比特校验位，`bi(i = 1, 2, ..., n)`，具体的公式如下所示：

![](https://i.imgtg.com/2023/04/12/8gmpM.png)



嵌入信息时，在对应校验位上嵌入信息比特 mi，若奇偶校验位 bi 与 mi 不匹配，则将该区域中所有元素的最低比特位翻转，使得校验位与 mi 相同，即 `bi = mi`



当一个区域内所有像素的最低比特有偶数个 1，得奇偶校验位 `bi = 0`



如果要嵌入的秘密信息比特为 1，即 `mi = 1`，要想满足 `bi = mi` 则需要翻转所有像素的最低比特位，使得该区域的最低有效位有奇数个 1，即 `bi = 1`，从而满足 `bi = mi`







- 2、提取





在接收端，收发方有共同的伪装密钥作为种子，可以伪随机地构造载体区域。收方从载体区域中计算出奇偶校验位，排列起来就可以重构秘密信息






### **2.思路二**


该思路特点是翻转像素少，实际上时把载体分成几个不相重叠的区域，在一个载体区域中存储`1 bit`信息



- 1、嵌入


与第一种思路不同的是 ，区域 I 隐藏一个信息比特。若 bi 与 mi 不同，则将该区域中某个像素的最低比特位进行翻转，使得奇偶校验位与 mi 相同，即 `bi = mi`。




- 2、提取



跟思路一相同，用同样的方法划分载体区域，计算出奇偶校验位，构成秘密信息



## 三、代码展示

采用第二种思路：

### **1.加密函数**

加密函数部分的代码如下所示：


```c++
x=rgb2gray(imread('lena.bmp'));
y=double(rgb2gray(imread('fig1.jpg')));
[m,n]=size(y);

origin=x;

%加密
for i=1:m
    for j=1:n
        if checksum(x,i,j)~=y(i,j)
            random=int8(rand()*3);
            switch random
                case 0
                    x(2*i-1,2*j-1)=bitset(x(2*i-1,2*j-1),1,~bitget(x(2*i-1,2*j-1),1));
                case 1
                    x(2*i-1,2*j)=bitset(x(2*i-1,2*j),1,~bitget(x(2*i-1,2*j),1));
                case 2
                    x(2*i,2*j-1)=bitset(x(2*i,2*j-1),1,~bitget(x(2*i,2*j-1),1));
                case 3
                    x(2*i,2*j)=bitset(x(2*i,2*j),1,~bitget(x(2*i,2*j),1));
            end
        end
    end
end

imwrite(x,'watermarkedImage.bmp');

subplot(2,2,1);
imshow(origin,[]);
title('原始图片');

subplot(2,2,2);
imshow(y,[]);
title('水印');

subplot(2,2,3);
imshow(x,[]);
title('密图');
```


### **2.解密函数**

解密函数部分的代码如下所示：


```c++
c=imread('watermarkedImage.bmp');
[m,n]=size(c);
secret=zeros(m/2,n/2);

for i=1:m/2
    for j=1:n/2
        secret(i,j)=checksum(c,i,j);
    end
end

%解密
imshow(secret,[]);
title('提取出的水印');
```



### **3.奇偶校验位函数**

奇偶校验位函数部分的代码如下所示：


```c++
function out=checksum(x,i,j)

%计算特定一维向量的第m个区域的最低位的校验和
    temp=zeros(1,4);
    temp(1)=bitget(x(2*i-1,2*j-1),1);
    temp(2)=bitget(x(2*i-1,2*j),1);
    temp(3)=bitget(x(2*i,2*j-1),1);
    temp(4)=bitget(x(2*i,2*j),1);
    out=rem(sum(temp),2);

end
```




## 四、实验结果
---



> 第一部分如下所示


![](https://i.imgtg.com/2023/04/12/8gP51.png)



> 第二部分如下所示





![](https://i.imgtg.com/2023/04/12/8gpYG.png)







## 五、总结与展望
---


本次实验利用 `MATLAB` 和基于奇偶校验位隐藏法，实现将秘密图像嵌入到位图中，并最后可以将其提取出来



通过对所学到的理论知识进行相应的应用，对`MATLAB`的应用也更加的熟练，最后期待自己未来更好的发展，`心想事成、万事胜意、未来可期`




